import{D as R,A as C,B as D,v as L,_ as H,S as M}from"./preact.module.6a90d538.js";import{j as l,a as c,d as j}from"./browser.15c0ea83.js";import{CounterIsland as A}from"./Counter.island.8e769ef4.js";import{ExpandableIsland as W}from"./Expandable.island.8acfa73a.js";const K=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};K();var z={};function p(e,t){for(var n in t)e[n]=t[n];return e}function B(e,t,n){var r,i=/(?:\?([^#]*))?(#.*)?$/,o=e.match(i),a={};if(o&&o[1])for(var f=o[1].split("&"),h=0;h<f.length;h++){var v=f[h].split("=");a[decodeURIComponent(v[0])]=decodeURIComponent(v.slice(1).join("="))}e=g(e.replace(i,"")),t=g(t||"");for(var N=Math.max(e.length,t.length),u=0;u<N;u++)if(t[u]&&t[u].charAt(0)===":"){var y=t[u].replace(/(^:|[+*?]+$)/g,""),m=(t[u].match(/[+*?]+$/)||z)[0]||"",x=~m.indexOf("+"),k=~m.indexOf("*"),w=e[u]||"";if(!w&&!k&&(m.indexOf("?")<0||x)){r=!1;break}if(a[y]=decodeURIComponent(w),x||k){a[y]=e.slice(u).map(decodeURIComponent).join("/");break}}else if(t[u]!==e[u]){r=!1;break}return(n.default===!0||r!==!1)&&a}function _(e,t){return e.rank<t.rank?1:e.rank>t.rank?-1:e.index-t.index}function q(e,t){return e.index=t,e.rank=function(n){return n.props.default?0:g(n.props.path).map(F).join("")}(e),e.props}function g(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function F(e){return e.charAt(0)==":"?1+"*+?".indexOf(e.charAt(e.length-1))||4:5}var J={},d=[],T=[],s=null,P={url:b()},G=R(P);function b(){var e;return""+((e=s&&s.location?s.location:s&&s.getCurrentLocation?s.getCurrentLocation():typeof location!="undefined"?location:J).pathname||"")+(e.search||"")}function U(e,t){return t===void 0&&(t=!1),typeof e!="string"&&e.url&&(t=e.replace,e=e.url),function(n){for(var r=d.length;r--;)if(d[r].canRoute(n))return!0;return!1}(e)&&function(n,r){r===void 0&&(r="push"),s&&s[r]?s[r](n):typeof history!="undefined"&&history[r+"State"]&&history[r+"State"](null,null,n)}(e,t?"replace":"push"),O(e)}function O(e){for(var t=!1,n=0;n<d.length;n++)d[n].routeTo(e)&&(t=!0);return t}function Q(e){if(e&&e.getAttribute){var t=e.getAttribute("href"),n=e.getAttribute("target");if(t&&t.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return U(t)}}function V(e){return e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),!1}function S(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button)){var t=e.target;do if(t.localName==="a"&&t.getAttribute("href")){if(t.hasAttribute("data-native")||t.hasAttribute("native"))return;if(Q(t))return V(e)}while(t=t.parentNode)}}var I=!1;function E(e){e.history&&(s=e.history),this.state={url:e.url||b()}}p(E.prototype=new H,{shouldComponentUpdate:function(e){return e.static!==!0||e.url!==this.props.url||e.onChange!==this.props.onChange},canRoute:function(e){var t=C(this.props.children);return this.g(t,e)!==void 0},routeTo:function(e){this.setState({url:e});var t=this.canRoute(e);return this.p||this.forceUpdate(),t},componentWillMount:function(){this.p=!0},componentDidMount:function(){var e=this;I||(I=!0,s||addEventListener("popstate",function(){O(b())}),addEventListener("click",S)),d.push(this),s&&(this.u=s.listen(function(t){var n=t.location||t;e.routeTo(""+(n.pathname||"")+(n.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),d.splice(d.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(e,t){e=e.filter(q).sort(_);for(var n=0;n<e.length;n++){var r=e[n],i=B(t,r.props.path,r.props);if(i)return[r,i]}},render:function(e,t){var n,r,i=e.onChange,o=t.url,a=this.c,f=this.g(C(e.children),o);if(f&&(r=D(f[0],p(p({url:o,matches:n=f[1]},n),{key:void 0,ref:void 0}))),o!==(a&&a.url)){p(P,a=this.c={url:o,previous:a&&a.url,current:r,path:r?r.props.path:null,matches:n}),a.router=this,a.active=r?[r]:[];for(var h=T.length;h--;)T[h]({});typeof i=="function"&&i(a)}return L(G.Provider,{value:a},r)}});var $=function(e){return L("a",p({onClick:S},e))};function X(){return l("main",{children:[c("h1",{children:"This page is completely static."}),c("section",{children:"An since it does not contain any interactive islands, no JavaScript is shipped to the browser."}),c($,{href:"..",children:"Home"})]})}function Y({children:e}){if(!e)throw new Error("TEST: THIS CODE MUST NOT SHOW UP IN THE CLIENT BUNDLE");return c("div",{children:e})}function Z(){return l("main",{children:[l("h1",{children:["Partial hydration with Preact and ",c("i",{children:"Capri"})]}),c("section",{children:"This page is static, but contains some dynamic parts."}),l("section",{children:["Here is a simple counter: ",c(A,{})]}),l("section",{children:["And here is another one, independent from the one above:"," ",c(A,{start:100})]}),l(W,{title:"Click to expand",children:["This is a layout island. Its children are only rendered upon build time. When hydrated, a static component is passed as only child which will render the original HTML subtree.",l(Y,{children:["The code for ",c("code",{children:"ServerContent"})," should not show up in the client bundle."]})]}),c($,{href:"about",children:"Link to another page"})]})}function ee(){return j(()=>{var n;const t=(n=new URL(window.location.href).searchParams.get("slug"))!=null?n:"/";U(t)}),null}function te(){return c("div",{class:"banner",children:"Preview Mode"})}function ne({url:e}){return l("div",{children:[!e&&c(te,{}),l(E,{url:e,children:[c(Z,{path:"/"}),c(X,{path:"/about"}),c(ee,{path:"/preview"})]})]})}M(c(ne,{}),document.body);
