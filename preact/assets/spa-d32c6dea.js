import"./modulepreload-polyfill-3cfb730f.js";import{F as X,y as h,t as Y,E as G,b as d,l,g,$ as b,q as ee}from"./preact.module-5b5c6b29.js";import{h as D,_ as V,p as te,T as K,y as ne,q as re,u as a}from"./jsxRuntime.module-c2757ce1.js";import P from"./Counter.island-9594f30d.js";import oe from"./Expandable.island-ce100eff.js";import ce from"./MediaQuery.island-68365400.js";const ae="popstate",k="pushState",w="replaceState",R=[ae,k,w],ie=({base:e=""}={})=>{const[{path:t},n]=D(()=>({path:C(e)})),r=V(t+location.search);te(()=>{const o=()=>{const i=C(e),s=i+location.search;r.current!==s&&(r.current=s,n({path:i}))};return R.forEach(i=>addEventListener(i,o)),o(),()=>R.forEach(i=>removeEventListener(i,o))},[e]);const c=K((o,{replace:i=!1}={})=>history[i?w:k](null,"",o[0]==="~"?o.slice(1):e+o),[e]);return[t,c]};if(typeof history<"u")for(const e of[k,w]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),r=new Event(e);return r.arguments=arguments,dispatchEvent(r),n}}const C=(e,t=location.pathname)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/";function se(e=le){let t={};const n=r=>t[r]||(t[r]=e(r));return(r,c)=>{const{regexp:o,keys:i}=n(r||""),s=o.exec(c);return s?[!0,i.reduce((p,f,_)=>(p[f.name]=s[_+1],p),{})]:[!1,null]}}const E=e=>e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),ue=(e,t,n)=>{let r=e?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return t&&n&&(r="(?:\\/"+r+")"),r+(t?"?":"")},le=e=>{const t=/:([A-Za-z0-9_]+)([?+*]?)/g;let n=null,r=0,c=[],o="";for(;(n=t.exec(e))!==null;){const[i,s,u]=n,p=u==="+"||u==="*",f=u==="?"||u==="*",_=f&&e[n.index-1]==="/"?1:0,Q=e.substring(r,n.index-_);c.push({name:s}),r=t.lastIndex,o+=E(Q)+ue(p,f,_)}return o+=E(e.substring(r)),{keys:c,regexp:new RegExp("^"+o+"(?:\\/)?$","i")}},W=X({}),j=({hook:e=ie,base:t="",matcher:n=se()}={})=>({hook:e,base:t,matcher:n}),x=()=>{const e=re(W);return e.v||(e.v=j())},z=()=>{const e=x();return e.hook(e)},_e=e=>{const[t]=z();return x().matcher(e,t)},B=e=>{const t=V(),[,n]=z();return t.current=()=>n(e.to||e.href,e),t},pe=e=>{const[t]=D(()=>({v:j(e)}));return h(W.Provider,{value:t,children:e.children})},y=({path:e,match:t,component:n,children:r})=>{const c=_e(e),[o,i]=t||c;return o?n?h(n,{params:i}):typeof r=="function"?r(i):r:null},I=(e,t)=>{const n=B(e),{base:r}=x();let{to:c,href:o=c,children:i,onClick:s}=e;const u=K(_=>{_.ctrlKey||_.metaKey||_.altKey||_.shiftKey||_.button!==0||(s&&s(_),_.defaultPrevented||(_.preventDefault(),n.current()))},[s]),p={href:o[0]==="~"?o.slice(1):r+o,onClick:u,to:null,ref:t},f=Y(i)?i:h("a",e);return G(f,p)},fe=e=>{const t=B(e);return ne(()=>{t.current()},[]),null};function he(e,t){for(var n in t)e[n]=t[n];return e}function S(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function $(e){this.props=e}($.prototype=new d).isPureReactComponent=!0,$.prototype.shouldComponentUpdate=function(e,t){return S(this.props,e)||S(this.state,t)};var O=l.__b;l.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),O&&O(e)};var de=l.__e;l.__e=function(e,t,n,r){if(e.then){for(var c,o=t;o=o.__;)if((c=o.__c)&&c.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),c.__c(e,t)}de(e,t,n,r)};var A=l.unmount;function Z(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=he({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return Z(r,t,n)})),e}function q(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return q(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function m(){this.__u=0,this.t=null,this.__b=null}function J(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function v(){this.u=null,this.o=null}l.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),A&&A(e)},(m.prototype=new d).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var c=J(r.__v),o=!1,i=function(){o||(o=!0,n.__R=null,c?c(s):s())};n.__R=i;var s=function(){if(!--r.__u){if(r.state.__a){var u=r.state.__a;r.__v.__k[0]=q(u,u.__c.__P,u.__c.__O)}var p;for(r.setState({__a:r.__b=null});p=r.t.pop();)p.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(i,i)},m.prototype.componentWillUnmount=function(){this.t=[]},m.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Z(this.__b,n,r.__O=r.__P)}this.__b=null}var c=t.__a&&h(g,null,e.fallback);return c&&(c.__u&=-33),[h(g,null,t.__a?null:e.children),c]};var L=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(v.prototype=new d).__a=function(e){var t=this,n=J(t.__v),r=t.o.get(e);return r[0]++,function(c){var o=function(){t.props.revealOrder?(r.push(c),L(t,e,r)):c()};n?n(o):o()}},v.prototype.render=function(e){this.u=null,this.o=new Map;var t=b(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},v.prototype.componentDidUpdate=v.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){L(e,n,t)})};var ve=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,me=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ye=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ge=/[A-Z0-9]/g,be=typeof document<"u",ke=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};d.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(d.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var T=l.event;function we(){}function xe(){return this.cancelBubble}function Pe(){return this.defaultPrevented}l.event=function(e){return T&&(e=T(e)),e.persist=we,e.isPropagationStopped=xe,e.isDefaultPrevented=Pe,e.nativeEvent=e};var Re={enumerable:!1,configurable:!0,get:function(){return this.class}},U=l.vnode;l.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,c={};for(var o in n){var i=n[o];if(!(o==="value"&&"defaultValue"in n&&i==null||be&&o==="children"&&r==="noscript"||o==="class"||o==="className")){var s=o.toLowerCase();o==="defaultValue"&&"value"in n&&n.value==null?o="value":o==="download"&&i===!0?i="":s==="ondoubleclick"?o="ondblclick":s!=="onchange"||r!=="input"&&r!=="textarea"||ke(n.type)?s==="onfocus"?o="onfocusin":s==="onblur"?o="onfocusout":ye.test(o)?o=s:r.indexOf("-")===-1&&me.test(o)?o=o.replace(ge,"-$&").toLowerCase():i===null&&(i=void 0):s=o="oninput",s==="oninput"&&c[o=s]&&(o="oninputCapture"),c[o]=i}}r=="select"&&c.multiple&&Array.isArray(c.value)&&(c.value=b(n.children).forEach(function(u){u.props.selected=c.value.indexOf(u.props.value)!=-1})),r=="select"&&c.defaultValue!=null&&(c.value=b(n.children).forEach(function(u){u.props.selected=c.multiple?c.defaultValue.indexOf(u.props.value)!=-1:c.defaultValue==u.props.value})),n.class&&!n.className?(c.class=n.class,Object.defineProperty(c,"className",Re)):(n.className&&!n.class||n.class&&n.className)&&(c.class=c.className=n.className),t.props=c}(e),e.$$typeof=ve,U&&U(e)};var H=l.__r;l.__r=function(e){H&&H(e),e.__c};var M=l.diffed;l.diffed=function(e){M&&M(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};const N=new Map,F=new Map,Ce={"/data":"loaded!"};function Ee(e){return new Promise(t=>setTimeout(()=>t(Ce[e]),100))}function Se(e){const t=F.get(e);if(t)return t;let n=N.get(e);throw n||(n=Ee(e).then(r=>F.set(e,r)),N.set(e,n)),n}function $e(){const e=Se("/data");return a("span",{children:[" ",e]})}function Oe(){return a("main",{children:[a("h1",{children:["This page is completely static. Async data:",a(m,{fallback:a("span",{children:" loading..."}),children:a($e,{})})]}),a("section",{children:"An since it does not contain any interactive islands, no JavaScript is shipped to the browser."}),a(I,{href:"/",children:a("a",{children:"Home"})})]})}function Ae({children:e}){return a("div",{children:e})}function Le(){return a("main",{children:[a("h1",{children:["Partial hydration with Preact and ",a("i",{children:"Capri"})]}),a("section",{children:"This page is static, but contains some dynamic parts."}),a("section",{children:["Here is a simple counter: ",a(P,{})]}),a("section",{children:["And here is another one, independent from the one above:"," ",a(P,{start:100})]}),a(oe,{title:"Click to expand",children:["This island receives children as prop. They are only rendered upon build time.",a(Ae,{children:["The code for ",a("code",{children:"ServerContent"})," won't show up in the client bundle."]})]}),a(ce,{}),a(I,{href:"/about",children:a("a",{children:"Link to another page"})})]})}function Te(){const t=new URL(window.location.href).searchParams.get("slug")??"/";return a(fe,{to:t})}function Ue(){return a("div",{class:"banner",children:"Preview Mode"})}function He(){return a(g,{children:[a(y,{path:"/",component:Le}),a(y,{path:"/about",component:Oe}),a(y,{path:"/preview",component:Te})]})}const Me="/capri/preact/".slice(0,-1);ee(a(pe,{base:Me,children:[a(Ue,{}),a(He,{})]}),document.body);
