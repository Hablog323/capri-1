import{D as E,A as C,B as N,v as R,_ as H,S as D}from"./preact.module.6a90d538.js";import{j as c,a as l,d as M}from"./browser.5ec74cb2.js";import{CounterIsland as A}from"./Counter.island.fb2ab591.js";import{ExpandableIsland as j}from"./Expandable.island.e3c5ad59.js";const W=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};W();var K={};function p(e,t){for(var n in t)e[n]=t[n];return e}function z(e,t,n){var r,i=/(?:\?([^#]*))?(#.*)?$/,o=e.match(i),a={};if(o&&o[1])for(var f=o[1].split("&"),h=0;h<f.length;h++){var v=f[h].split("=");a[decodeURIComponent(v[0])]=decodeURIComponent(v.slice(1).join("="))}e=g(e.replace(i,"")),t=g(t||"");for(var $=Math.max(e.length,t.length),s=0;s<$;s++)if(t[s]&&t[s].charAt(0)===":"){var y=t[s].replace(/(^:|[+*?]+$)/g,""),m=(t[s].match(/[+*?]+$/)||K)[0]||"",w=~m.indexOf("+"),x=~m.indexOf("*"),k=e[s]||"";if(!k&&!x&&(m.indexOf("?")<0||w)){r=!1;break}if(a[y]=decodeURIComponent(k),w||x){a[y]=e.slice(s).map(decodeURIComponent).join("/");break}}else if(t[s]!==e[s]){r=!1;break}return(n.default===!0||r!==!1)&&a}function B(e,t){return e.rank<t.rank?1:e.rank>t.rank?-1:e.index-t.index}function _(e,t){return e.index=t,e.rank=function(n){return n.props.default?0:g(n.props.path).map(q).join("")}(e),e.props}function g(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function q(e){return e.charAt(0)==":"?1+"*+?".indexOf(e.charAt(e.length-1))||4:5}var F={},d=[],L=[],u=null,I={url:b()},J=E(I);function b(){var e;return""+((e=u&&u.location?u.location:u&&u.getCurrentLocation?u.getCurrentLocation():typeof location!="undefined"?location:F).pathname||"")+(e.search||"")}function P(e,t){return t===void 0&&(t=!1),typeof e!="string"&&e.url&&(t=e.replace,e=e.url),function(n){for(var r=d.length;r--;)if(d[r].canRoute(n))return!0;return!1}(e)&&function(n,r){r===void 0&&(r="push"),u&&u[r]?u[r](n):typeof history!="undefined"&&history[r+"State"]&&history[r+"State"](null,null,n)}(e,t?"replace":"push"),U(e)}function U(e){for(var t=!1,n=0;n<d.length;n++)d[n].routeTo(e)&&(t=!0);return t}function G(e){if(e&&e.getAttribute){var t=e.getAttribute("href"),n=e.getAttribute("target");if(t&&t.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return P(t)}}function Q(e){return e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),!1}function V(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button)){var t=e.target;do if(t.localName==="a"&&t.getAttribute("href")){if(t.hasAttribute("data-native")||t.hasAttribute("native"))return;if(G(t))return Q(e)}while(t=t.parentNode)}}var T=!1;function O(e){e.history&&(u=e.history),this.state={url:e.url||b()}}p(O.prototype=new H,{shouldComponentUpdate:function(e){return e.static!==!0||e.url!==this.props.url||e.onChange!==this.props.onChange},canRoute:function(e){var t=C(this.props.children);return this.g(t,e)!==void 0},routeTo:function(e){this.setState({url:e});var t=this.canRoute(e);return this.p||this.forceUpdate(),t},componentWillMount:function(){this.p=!0},componentDidMount:function(){var e=this;T||(T=!0,u||addEventListener("popstate",function(){U(b())}),addEventListener("click",V)),d.push(this),u&&(this.u=u.listen(function(t){var n=t.location||t;e.routeTo(""+(n.pathname||"")+(n.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),d.splice(d.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(e,t){e=e.filter(_).sort(B);for(var n=0;n<e.length;n++){var r=e[n],i=z(t,r.props.path,r.props);if(i)return[r,i]}},render:function(e,t){var n,r,i=e.onChange,o=t.url,a=this.c,f=this.g(C(e.children),o);if(f&&(r=N(f[0],p(p({url:o,matches:n=f[1]},n),{key:void 0,ref:void 0}))),o!==(a&&a.url)){p(I,a=this.c={url:o,previous:a&&a.url,current:r,path:r?r.props.path:null,matches:n}),a.router=this,a.active=r?[r]:[];for(var h=L.length;h--;)L[h]({});typeof i=="function"&&i(a)}return R(J.Provider,{value:a},r)}});function S({href:e,children:t}){return c("a",{href:X(e),children:t})}function X(e){return typeof window=="undefined"?e:new URL(e,window.location.href).pathname}function Y(){return l("main",{children:[c("h1",{children:"This page is completely static."}),c("section",{children:"An since it does not contain any interactive islands, no JavaScript is shipped to the browser."}),c(S,{href:"..",children:"Home"})]})}function Z({children:e}){if(!e)throw new Error("TEST: THIS CODE MUST NOT SHOW UP IN THE CLIENT BUNDLE");return c("div",{children:e})}function ee(){return l("main",{children:[l("h1",{children:["Partial hydration with Preact and ",c("i",{children:"Capri"})]}),c("section",{children:"This page is static, but contains some dynamic parts."}),l("section",{children:["Here is a simple counter: ",c(A,{})]}),l("section",{children:["And here is another one, independent from the one above:"," ",c(A,{start:100})]}),l(j,{title:"Click to expand",children:["This is a layout island. Its children are only rendered upon build time. When hydrated, a static component is passed as only child which will render the original HTML subtree.",l(Z,{children:["The code for ",c("code",{children:"ServerContent"})," should not show up in the client bundle."]})]}),c(S,{href:"about",children:"Link to another page"})]})}function te(){return M(()=>{var n;const t=(n=new URL(window.location.href).searchParams.get("slug"))!=null?n:"/";P(t)}),null}function ne(){return c("div",{class:"banner",children:"Preview Mode"})}function re({url:e}){return l("div",{children:[!e&&c(ne,{}),l(O,{url:e,children:[c(ee,{path:"/"}),c(Y,{path:"/about"}),c(te,{path:"/preview"})]})]})}D(c(re,{}),document.body);
